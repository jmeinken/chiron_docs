<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>create a subcollection ID &mdash; Chiron 4.3.2 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="create current age field from birth/death dates" href="example9.html" />
    <link rel="prev" title="subject ID concept from Chiron subject ID field" href="example7.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Chiron
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Versions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../version_changelog.html">Version Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Explanation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../system_overview.html">System Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_dict.html">Understanding the Data Dictionary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../processors.html">Understanding Processors and Handlers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How To:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install Django and Chiron</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dd_configure.html">Configure the Data Dictionary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_code.html">Create Processors and Handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../etl.html">Run the ETL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy.html">Deploy to Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manage_users.html">Manage Users and Permissions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="example1.html">calculated concept - single source</a></li>
<li class="toctree-l2"><a class="reference internal" href="example2.html">calculated concept - multiple sources, subject data</a></li>
<li class="toctree-l2"><a class="reference internal" href="example3.html">calculated concept - multiple sources, subcollection data</a></li>
<li class="toctree-l2"><a class="reference internal" href="example4.html">calculated concept - multiple sources, subcollection data, longitudinal</a></li>
<li class="toctree-l2"><a class="reference internal" href="example5.html">deidentified subject ID from PHI subject ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="example6.html">subject ID when your source data doesn't have one</a></li>
<li class="toctree-l2"><a class="reference internal" href="example7.html">subject ID concept from Chiron subject ID field</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">create a subcollection ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="example9.html">create current age field from birth/death dates</a></li>
<li class="toctree-l2"><a class="reference internal" href="example10.html">create detailed age field from birth date and event date</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utilities.html">Site Admin Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chiron_settings.html">Chiron Global Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_models.html">User &amp; Permission Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_dict_models.html">Data Dictionary Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../processor_classes.html">Processor and Handler Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Chiron API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chiron</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../examples.html">Examples</a> &raquo;</li>
      <li>create a subcollection ID</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/topics/examples/example8.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="create-a-subcollection-id">
<span id="example8"></span><h1>create a subcollection ID<a class="headerlink" href="#create-a-subcollection-id" title="Permalink to this headline">ÔÉÅ</a></h1>
<p>EXAMPLE: We have a subcollection <code class="docutils literal notranslate"><span class="pre">procedures</span></code> that has doesn't have a unique ID for each record.
We would like to create an artificial procedure ID that's deidentified, unique for
each procedure event, and doesn't change every time the ETL runs.</p>
<hr>
<p>The concept handler we will use for this is <code class="docutils literal notranslate"><span class="pre">GeneratedSubcollectionIdHandler</span></code>. We must provide it
with an input concept or set of concepts that uniquely identifies a procedure. Concepts can come from
both the procedure collection and the subject collection. In this example, we will assume that
the subject ID, the procedure name, and the procedure date are enough to uniquely identify a
procedure event.</p>
<ol class="arabic simple">
<li><p>Set up the data dictionary to load the sources that create concepts for our three input IDs
(subject_id, procedure_name, procedure_date).</p></li>
<li><p>In the data dictionary, we're going to add a new source for iterating the procedure collection in the Chiron database:</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">name</dt>
<dd class="field-odd"><p>give any name you want, ex. &quot;chiron_procedure_collection&quot;</p>
</dd>
<dt class="field-even">collection</dt>
<dd class="field-even"><p>select the procedure collection</p>
</dd>
<dt class="field-odd">processor</dt>
<dd class="field-odd"><p>SourceSelfSubdoc</p>
</dd>
<dt class="field-even">execution_order</dt>
<dd class="field-even"><p>must be run after all our input data (subject_id, procedure_name, procedure_date) is loaded</p>
</dd>
</dl>
<ol class="arabic simple" start="3">
<li><p>In the data dictionary, create a concept for our procedure ID</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">permanent_id</dt>
<dd class="field-odd"><p>give any name you want, ex. &quot;procedure_id&quot;</p>
</dd>
<dt class="field-even">name</dt>
<dd class="field-even"><p>&quot;procedure ID&quot;</p>
</dd>
<dt class="field-odd">source</dt>
<dd class="field-odd"><p>select the source you created in step 2</p>
</dd>
<dt class="field-even">concept_handler</dt>
<dd class="field-even"><p>GeneratedSubcollectionIdHandler</p>
</dd>
<dt class="field-odd">collection</dt>
<dd class="field-odd"><p>select the collection the calculated field will go in, i.e. the procedure collection</p>
</dd>
<dt class="field-even">Concept handler args</dt>
<dd class="field-even"><p>Provide a comma separated list of procedure concepts (and optionally a comma separated list of
subject concepts) to use as inputs for generating the procedure ID
(name=&quot;subcol_fields&quot;, value=&quot;proc_name_dycdfyckfp, proc_date_xrvwavsftu&quot;);
(name=&quot;subject_fields&quot;, value=&quot;subject_id_xctwybwqxh&quot;)</p>
</dd>
<dt class="field-odd">Concept-concept dependencies</dt>
<dd class="field-odd"><p>include <cite>proc_name_dycdfyckfp</cite>, <cite>proc_date_xrvwavsftu</cite>, <cite>subject_id_xctwybwqxh</cite> (if Chiron knows this concept
depends on these concepts, it will help protect you from doing something stupid like loading
them in the wrong order)</p>
</dd>
</dl>
<p>The remaining fields can be filled in as you wish.</p>
<ol class="arabic simple" start="4">
<li><p>That should be it. The next time you run the ETL, your new self-referential source should run
at the end and populate your new calculated concept.</p></li>
</ol>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="example7.html" class="btn btn-neutral float-left" title="subject ID concept from Chiron subject ID field" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="example9.html" class="btn btn-neutral float-right" title="create current age field from birth/death dates" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, UC Center for Health Informatics, Cincinnati Children&#39;s Biomedical Informatics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>